version: "3.7"

services:
  api-gateway:
    container_name: api-gateway
    image: envoyproxy/envoy:v1.24.1
    ports:
      - 9901:9901
      - 10000:10000
      - 10001:10001
    volumes:
      - ./ApiGateway/Envoy:/etc/envoy
      - ./ApiGateway/Certificates/https.crt:/etc/ssl/certs/https.crt
      - ./ApiGateway/Certificates/key.pem:/etc/ssl/certs/key.pem

      
  authenticate-api:
      container_name: authenticate-api
      image: authenticateapi
      build:
        context: AuthenticateApi/
        dockerfile: ./Authenticate.Api/Dockerfile
      environment:
        ASPNETCORE_URLS: "https://+;http://+"
        ASPNETCORE_HTTPS_PORT: "8011"
        ASPNETCORE_ENVIRONMENT: Development
      volumes:
        - ${APPDATA}\microsoft\UserSecrets\:/root/.microsoft/usersecrets
        - ${USERPROFILE}\.aspnet\https:/root/.aspnet/https/
      ports:
        - 8010:80
        - 8011:443
      depends_on:
        - api-gateway

  
    